/*!
 * Excolo Slider - A simple jquery slider
 *
 * Examples and documentation at:
 * http://excolo.github.io/Excolo-Slider/
 *
 * Author: Nikolaj Dam Larsen
 * Version: 1.1.0 (16-MAY-2014)
 *
 * Released under the MIT license
 * https://github.com/Excolo/ExcoloSlider/blob/master/LICENSE
 */
(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e){var t;t=function(){function t(t,n){this.elem=t;this.$elem=e(t);this.options=n;this.metadata=this.$elem.data("plugin-options")}return t}();t.prototype={defaults:{width:800,height:530,autoSize:true,touchNav:true,mouseNav:true,prevnextNav:true,prevnextAutoHide:true,pagerNav:true,startSlide:1,autoPlay:true,delay:0,interval:3e3,repeat:true,playReverse:false,hoverPause:true,captionAutoHide:false,animationCssTransitions:true,animationDuration:500,animationTimingFunction:"linear",prevButtonClass:"slide-prev",nextButtonClass:"slide-next",activeSlideClass:"es-active",slideCaptionClass:"es-caption",pagerClass:"es-pager"},init:function(){var t,n,r,i,s,o,u,a,f,l;t=this;t.config=e.extend({},t.defaults,t.options,t.metadata);t.actionClick={action:false,x:0,y:0};t.currClick={x:0,y:0};t.data=e.data(t);e.data(t,"currentSlide",t.config.playReverse&&t.config.startSlide==1?t.$elem.children().length-1:t.config.startSlide-1);e.data(t,"nextSlide",t.data.currentSlide);e.data(t,"totalslides",t.$elem.children().length);e.data(t,"browserEnginePrefix",t._getBrowserEnginePrefix());e.data(t,"isPlaying",false);e.data(t,"isAnimating",false);e.data(t,"playPaused",false);e.data(t,"justTouched",false);e.data(t,"isMoving",false);e.data(t,"width",t.config.width);t.$elem.addClass("slider");t.$elem.css({position:"relative"});t.$elem.wrapInner("<div class='slide-wrapper'>",t.$elem).children();t.$elem.wrapInner("<div class='slide-container'>",e(".slide-wrapper",t.$elem)).children();t.$elem.wrapInner("<div class='slide-dragcontainer'>",e(".slide-container",t.$elem)).children();e(".slide-container",t.$elem).css({position:"relative"});l=e(".slide-dragcontainer",t.$elem);a=e(".slide-wrapper",t.$elem);f=a.children();if(t.config.prevnextNav){a.after("<div class='"+t.config.nextButtonClass+"'>");a.after("<div class='"+t.config.prevButtonClass+"'>");i=e("."+t.config.nextButtonClass,t.$elem);r=e("."+t.config.prevButtonClass,t.$elem);s=i.add(r);if(t.config.prevnextAutoHide){s.hide();t.$elem.hover(function(){s.fadeIn("fast")},function(){s.fadeOut("fast")})}r.on("click",function(e){t.previous()});i.on("click",function(e){t.next()});r.on("touchstart",function(e){e.stopPropagation()});i.on("touchstart",function(e){e.stopPropagation()})}if(t.config.pagerNav){t.$elem.append("<ul class='"+t.config.pagerClass+"'>");f.each(function(){e("<li />").appendTo(e("."+t.config.pagerClass,t.$elem)).attr("rel",e(this).index()).on("click",function(){e.data(t,"nextSlide",parseInt(e(this).attr("rel")));t._prepareslides(true);t._slide(true);t._manualInterference()})})}f.each(function(){o=e(this);u=o.data("plugin-slide-caption");if(u===undefined)return;if(this.tagName=="IMG"){o.wrap("<div>");o.after("<div class='"+t.config.slideCaptionClass+"'>");o.next().append(u)}else{o.append("<div class='"+t.config.slideCaptionClass+"'>");o.children().last().append(u)}if(t.config.captionAutoHide){e("."+t.config.slideCaptionClass,t.$elem).hide();t.$elem.hover(function(){e("."+t.config.slideCaptionClass,t.$elem).fadeIn("fast")},function(){e("."+t.config.slideCaptionClass,t.$elem).fadeOut("fast")})}});a.children().addClass("slide").css({position:"absolute",top:0,left:0,width:t.data.width,height:t.config.height,zIndex:0,display:"none",webkitBackfaceVisibility:"hidden"});n=f.height();a.css({position:"relative",left:0,height:n});e(".slide-container",t.$elem).css({width:t.data.width,overflow:"hidden",height:n});if(t.config.touchNav){l.on("touchstart",function(e){var n=e.originalEvent.touches[0];e.preventDefault();t._onMoveStart(n.pageX,n.pageY);t.actionClick.x=t.currClick.x=n.pageX;t.actionClick.y=t.currClick.y=n.pageY;t.actionClick.action=true;return e.stopPropagation()});l.on("touchmove",function(e){var n=e.originalEvent.touches[0];e.preventDefault();t.actionClick.action=false;t._onMove(n.pageX,n.pageY);t.currClick.x=n.pageX;t.currClick.y=n.pageY;return e.stopPropagation()});l.on("touchend",function(e){if(t.actionClick.action==true&&t.actionClick.x==t.currClick.x&&t.actionClick.y==t.currClick.y){var n=l.find("."+t.config.activeSlideClass+" a, a."+t.config.activeSlideClass).attr("href");if(n!=undefined&&n!=""){window.location=n}}e.preventDefault();t._onMoveEnd();return e.stopPropagation()})}if(t.config.mouseNav){l.css("cursor","pointer");l.on("dragstart",function(e){return false});l.on("mousedown",function(n){t._onMoveStart(n.clientX,n.clientY);t.actionClick.x=n.clientX;t.actionClick.y=n.clientY;t.actionClick.action=false;e(window).attr("unselectable","on").on("selectstart",false).css("user-select","none").css("UserSelect","none").css("MozUserSelect","none");return n.stopPropagation()});e(window).on("mousemove",function(e){t._onMove(e.clientX,e.clientY);return e.stopPropagation()});e(window).on("mouseup",function(n){t._onMoveEnd();if(t.actionClick.x==n.clientX&&t.actionClick.y==n.clientY){t.actionClick.action=true}e(window).removeAttr("unselectable").unbind("selectstart").css("user-select",null).css("UserSelect",null).css("MozUserSelect",null);return n.stopPropagation()});l.on("mouseup",function(e){if(t.actionClick.x==e.clientX&&t.actionClick.y==e.clientY){t.actionClick.action=true}});l.on("click",function(e){if(t.actionClick.action!=true){e.stopPropagation();e.preventDefault()}})}if(t.config.autoSize){setTimeout(function(){t._resize()},50);e(window).resize(function(){return setTimeout(function(){t._resize()},50)})}t._prepareslides();t.gotoSlide(t.data.currentSlide);if(t.config.autoPlay){setTimeout(function(){t.start()},t.config.delay)}return this},previous:function(){var t,n;t=this;e.data(t,"slideDirection","previous");n=(t.data.nextSlide-1)%t.data.totalslides;if(!t.config.repeat&&t.data.nextSlide-1<0){if(t.config.playReverse){e.data(t,"playPaused",true);t.stop()}return}else if(t.data.playPaused&&t.data.nextSlide-1>0){e.data(t,"playPaused",false);t.start()}e.data(t,"nextSlide",n);return this._slide()},next:function(){var t,n;t=this;e.data(t,"slideDirection","next");n=(t.data.nextSlide+1)%t.data.totalslides;if(!t.config.repeat&&t.data.nextSlide+1>t.data.totalslides-1){if(!t.config.playReverse){e.data(t,"playPaused",true);t.stop()}return}else if(t.data.playPaused&&t.data.nextSlide+1<t.data.totalslides-1){e.data(t,"playPaused",false);t.start()}e.data(t,"nextSlide",n);return this._slide()},start:function(){var t,n,r;t=this;n=e(".slide-container",t.$elem);if(t.data.isPlaying&&t.data.playTimer)clearInterval(t.data.playTimer);r=setInterval(function(){if(t.config.playReverse)t.previous();else t.next()},t.config.interval);e.data(t,"playTimer",r);if(t.config.hoverPause){n.unbind();n.hover(function(){e.data(t,"playPaused",true);return t.stop()},function(){e.data(t,"playPaused",false);return t.start()})}e.data(t,"isPlaying",true)},stop:function(){var t,n;t=this;n=e(".slide-container",t.$elem);clearInterval(t.data.playTimer);e.data(t,"playTimer",null);if(t.config.hoverPause&&!t.data.playPaused)n.unbind();e.data(t,"isPlaying",false)},gotoSlide:function(t){var n,r,i,s,o,u;n=this;e.data(n,"nextSlide",t%n.data.totalslides);r=t%n.data.totalslides;e.data(n,"currentSlide",r);i=e(".slide-wrapper",n.$elem);s=i.children();o=i.children().eq(r);u=o.position().left;n._setActive(s,o);if(n.config.animationCssTransitions&&n.data.browserEnginePrefix){n._transition(-u,0)}else{i.css("left",-u)}n._alignSlides(u)},_manualInterference:function(){var e=this;if(e.data.isPlaying){e.stop();e.start()}},_prepareslides:function(t){var n,r,i,s,o,u;n=this;r=e(".slide-wrapper",n.$elem);i=r.children();s=n.data.width;o=Math.floor(n.data.totalslides/2);u=0;i.each(function(){e(this).css({display:"block",left:s*u,zIndex:10});u++;if(!t&&n.config.repeat&&u>o)u=n.data.totalslides%2?-o:-(o-1)})},_onMoveStart:function(t,n){var r=this;if(!r.data.isMoving)e.data(r,"touchTime",Number(new Date));e.data(r,"touchedX",t);e.data(r,"touchedY",n);e.data(r,"isMoving",true);if(r.data.isPlaying){e.data(r,"playPaused",true);r.stop()}},_onMove:function(t,n){var r,i,s,o,u,a,f;r=this;if(!r.data.isMoving)return;i=e(".slide-wrapper",r.$elem);e.data(r,"scrolling",Math.abs(t-r.data.touchedX)<Math.abs(n-r.data.touchedY));if(!r.data.scrolling&&!r.data.isAnimating){s=i.children().eq(r.data.nextSlide);o=s.position().left;u=r.data.browserEnginePrefix.css;a=t-r.data.touchedX;f=r.data.width*.1;if(!r.config.repeat){if(r.data.currentSlide<=0&&-a<-f)a=f;else if(r.data.currentSlide>=r.data.totalslides-1&&-a>f)a=-f}r._transition(-o+a,0)}},_onMoveEnd:function(){var t,n,r,i,s,o,u;t=this;if(!t.data.isMoving)return;n=e(".slide-wrapper",t.$elem);e.data(t,"justTouched",true);r=n.children().eq(t.data.nextSlide);i=r.position().left;s=t.data.width*.5;o=t.data.width*.1;u=Number(new Date)-t.data.touchTime<250;if(!t.config.repeat&&(n.position().left<-i&&t.data.currentSlide>=t.data.totalslides-1||n.position().left>-i&&t.data.currentSlide<=0)){t._transition(-i,.15)}else if(n.position().left>-i+s||n.position().left>-i+o&&u){this.previous()}else if(n.position().left<-(i+s)||n.position().left<-(i+o)&&u){this.next()}else{t._transition(-i,.15)}t._alignSlides(i);e.data(t,"isMoving",false);e.data(t,"justTouched",false);if(t.data.playPaused)t.start()},_alignSlides:function(t){var n,r,i,s,o,u,a,f,l,c,h;n=this;if(!n.config.repeat)return;r=e(".slide-wrapper",n.$elem);i=r.children();if(t===undefined){s=r.children().eq(n.data.nextSlide);t=s.position().left}t=Math.round(t,0);o=Math.ceil(n.data.totalslides/2);u=n.data.width;a=0;i.each(function(){var n=Math.round(e(this).position().left);if(n>Math.round(t-u))a++});f=o-a;if(f<0)f=n.data.totalslides%2==0?f+1:f;for(l=0;l<Math.abs(f);l++){c=[].reduce.call(i,function(t,n){return e(t).offset().left<e(n).offset().left?t:n});h=[].reduce.call(i,function(t,n){return e(t).offset().left>e(n).offset().left?t:n});if(f>0)e(c).css("left",Math.round(e(h).position().left+u));else e(h).css("left",Math.round(e(c).position().left-u))}},_slide:function(t){var n,r,i,s,o,u;n=this;r=n.data.nextSlide;i=e(".slide-wrapper",n.$elem);s=i.children();o=i.children().eq(r);u=Math.round(o.position().left);n._setActive(s,o);if(!t)n._alignSlides(u);e.data(n,"isAnimating",true);if(n.config.animationCssTransitions&&n.data.browserEnginePrefix){n._transition(-u,n.data.justTouched?.5:1);i.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){e.data(n,"currentSlide",r);i.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd");if(t)n._alignSlides(u)})}else{i.stop().animate({left:-u},n.config.animationDuration,function(){e.data(n,"currentSlide",r);e.data(n,"isAnimating",false);e.data(n,"justTouched",false)})}},_transition:function(t,n){var r,i,s,o,u,a;r=this;i=e(".slide-wrapper",r.$elem);if(n===undefined||n<0){n=1}s=r.data.browserEnginePrefix.css;o=s+"Transform";u=s+"TransitionDuration";a=s+"TransitionTimingFunction";i[0].style[u]=r.config.animationDuration*n+"ms";i[0].style[a]=r.config.animationTimingFunction;i[0].style[o]="translateX("+t+"px)";i.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){e.data(r,"isAnimating",false);e.data(r,"justTouched",false);i.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd")})},_setActive:function(t,n){var r=this,i,s;i=r.config.activeSlideClass;t.removeClass(i);n.addClass(i);if(r.config.pagerNav){s=e("."+r.config.pagerClass,r.$elem);s.children().removeClass("act");s.find("[rel="+n.index()+"]").addClass("act")}},_resize:function(){var t,n,r,i,s;t=this;if(t.data.isPlaying){e.data(t,"playPaused",true);t.stop()}n=t.$elem.width();r=t.config.height/t.config.width;i=n*r;e.data(t,"width",n);e(".slide",t.$elem).css({width:n,height:i});s=e(".slide-wrapper",t.$elem).children().height();e(".slide-wrapper",t.$elem).css({height:s});e(".slide-container",t.$elem).css({width:n,height:s});if(t.data.playPaused){e.data(t,"playPaused",false);t.start()}t._prepareslides();t.gotoSlide(t.data.currentSlide)},_getBrowserEnginePrefix:function(){var e,t,n;e="Transition";t=["Moz","Webkit","Khtml","O","ms"];n=0;while(n<t.length){if(typeof document.body.style[t[n]+e]==="string"){return{css:t[n]}}n++}return false}};t.defaults=t.prototype.defaults;e.fn.excoloSlider=function(e){return this.each(function(){(new t(this,e)).init()})}})